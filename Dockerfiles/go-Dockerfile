# Copyright The OpenTelemetry Authors
# SPDX-License-Identifier: Apache-2.0

FROM golang:1.22-alpine AS builder

WORKDIR /usr/src/app/

COPY go.mod go sum ./
RUN --mount=type=cache,target=/go/pkg/mod/ \
    --mount=type=bind,source=./src/checkout/go.sum,target=go.sum \
    --mount=type=bind,source=./src/checkout/go.mod,target=go.mod \
    go mod download


COPY . .
RUN go build-o produc-catalog


FROM alpine as release

WORKDIR /usr/src/app/

COPY --from=builder /go/bin/checkout/ ./

#ENV PRODUCT_CATALOG_PORT 8088
EXPOSE ${CHECKOUT_PORT}
ENTRYPOINT [ "./checkout" ]